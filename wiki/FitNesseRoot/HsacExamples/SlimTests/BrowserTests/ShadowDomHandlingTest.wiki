!1 Website testing using !-BrowserTest-!

On this page we will see the basic usage of the [[shadow automation selenium plugin][https://github.com/sukgu/shadow-automation-selenium]] by [[sukgu][https://github.com/sukgu/shadow-automation-selenium/commits?author=sukgu]] to
find elements that are insade a shadow DOM. 

The plugin only uses technical selectors to find elements, to be specific you need to specify the CSS selector of the element you want to find/click.
Below is a simple example using the shadow automation plugin. The plugin is integrated into fitnesse and uses the methods of BrowserTest.

!3 All new methods for shadow DOM handling

-|Comment                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|'''Command'''                                                             |'''Description'''                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|set shadow dom handling to <true/false>                                   |Controls whether !-BrowserTest-! should look for elements inside a shadow DOM if it does not find anything  (default 'true').                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|set implicit wait for shadow to <seconds>                                 |Sets the implicit wait time for shadow dom handling to a given number of seconds. The test will wait the given amount of seconds and then proceed.                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|set explicit wait for shadow to <seconds>                                 |Sets the explicit wait time for shadow dom handling. The test will wait for maximum of the given seconds and checks every second for an element until it finds something. The polling time is set to 1 by default and can be changed with "set polling time for shadow to <seconds>".                                                                                                                                                                                                                                                                                                                  |
|set polling time for shadow to <seconds>                                  |Sets the polling time for the explicit wait time for shadow dom handling.The default value is 1 second. The polling time has to be less than the wait time or an exception will get thrown.                                                                                                                                                                                                                                                                                                                                                                                                            |

!3 Simple example

|script| Browser Test|
|open | https://virustotal.com|
|note| set shadow dom handling to | false|
|note| set explicit wait for shadow to | 5|
| note| set implicit wait for shadow to |10|
|note| set polling time for shadow to | 3|
|click | home-view#home-view>vt-ui-button[data-route='url']|

!3 All BrowserTests Methods that support shadow DOM handling

-|Comment                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|'''Command'''                                                             |'''Description'''                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|click <place>                                                             |performs mouse click at the designated place (e.g. link/button/checkbox/radio button)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|click <place> at offset X <horizontalOffset> Y <verticalOffset>           |performs mouse click at offset from center of the designated place (e.g. link/button/checkbox/radio button)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|click if available <place>                                                |performs mouse click at the designated place (e.g. link/button/checkbox/radio button). Does not throw an exception on timeout but returns !style_code[false], so can be used with script table's 'reject' verb to check something cannot be clicked.                                                                                                                                                                                                                                                                                                                                                   |
|double click <place>                                                      |performs mouse double click at the designated place (e.g. link/button/checkbox/radio button)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|double click <place> at offset X <horizontalOffset> Y <verticalOffset>    |performs mouse double click at offset from center of the designated place (e.g. link/button/checkbox/radio button)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|right click <place>                                                       |performs right mouse button click (a.k.a. context click) at the designated place (e.g. link/button/checkbox/radio button)                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|right click <place> at offset X <horizontalOffset> Y <verticalOffset>     |performs mouse right click at offset from center of the designated place (e.g. link/button/checkbox/radio button)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|shift click <place>                                                       |performs mouse click while holding shift key at the designated place (e.g. link/button/checkbox/radio button)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|control click <place>                                                     |performs mouse click while holding control key at the designated place (e.g. link/button/checkbox/radio button). If 'send command for control on Mac' is enabled 'Cmd' (i.e. command) key will be pressed instead of 'Ctrl' (i.e. control).                                                                                                                                                                                                                                                                                                                                                            |
|enter <value> as <input>                                                  |clears the current value of an input and types the value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|enter <value> for <input>                                                 |types the value, appending to the current value of the input                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|select <value> as <input>                                                 |selects a value in the drop down box (or radio button), clearing before selecting the value in case of a multi-selectbox.                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|select <value> for <input>                                                |selects a value in the drop down box (or radio button), appending to the selection in case of a multi-selectbox.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|enter date <value> as <place>                                             |replaces the current value of an input of type 'date' (i.e. using the HTML5 datepicker) with the supplied value. The value must be in the format yyyy-mm-dd.                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|available options for <input>                                             |retrieves all possible values for the drop down box                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|clear <input>                                                             |removes the content in the input                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|take screenshot <name> of <place>                                         |takes a screenshot and crops it to the designated place, effectively screenshotting only the given element                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|value of <input>                                                          |retrieves the current value of the input (for use with 'check' verb or variable assignment)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|normalized value of <input>                                               |retrieves the normalized current value of the input (for use with 'check' verb or variable assignment). Normalized means all sequences of whitespace are collapsed to a single space.                                                                                                                                                                                                                                                                                                                                                                                                                  |
|values of <place>                                                         |retrieves all values of place, which is expected to be a 'select' or list                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|normalized values of <place>                                              |retrieves all normalized values of place, which is expected to be a 'select' or list. Normalized means all sequences of whitespace are collapsed to a single space.                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|is (not) visible <place> (in <container>)                                 |whether specified place is or becomes (not) visible in browser's window (used in combination with 'ensure').                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|is (not) visible on page <place> (in <container>)                         |whether specified place is or becomes (not) visible on the page, scrolling may be required to actually show it (used in combination with 'ensure').                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|is enabled <place>                                                        |whether specified place is enabled (i.e. can be clicked) (used in combination with 'ensure' and 'reject')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|is disabled <place>                                                       |whether specified place is disabled (i.e. cannot be clicked) (used in combination with 'ensure' and 'reject')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|scroll to <place>                                                         |scrolls the designated place into view                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|hover over <place>                                                        |simulates hovering over the designated place with the mouse (so e.g. 'mouseover' behavior can be tested)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|drag and drop <place> to <target>                                         |drags the designated place to the target (also works for HTML5 drag and drop if the source element has the !style_code[draggable] attribute)                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|drag and drop <element> to offset X <horizontalOffset> Y <verticalOffset> |drags the designated element to the target offset from current location                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|html5 drag and drop <place> to <target>                                   |drags the designated (html5 draggable) place to the target, forcing the html5 drag and drop javascript (works for all HTML5 drag and drop functionality (including images, links, etc, but does not support all jquery or other framework variations)                                                                                                                                                                                                                                                                                                                                                  |
|wait for visible <place>                                                  |waits until the specified place (i.e. element) is visible in the browser                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|select file <file>                                                        |Selects the supplied file using the first file input on the page. The file may be in the wiki's files section, or on the local file system.                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|select file <file> for <file input>                                       |Selects the supplied file using the indicated input. The file may be in the wiki's files section, or on the local file system.                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|tooltip for <place>                                                       |Retrieves the value of the tooltip that is shown when the mouse is placed on the place (the 'title' attribute)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|refresh until <place> is visible on page                                  |Refreshes current page until 'place' is found somewhere on the page. Do not forget to set 'repeat at most times', or else the loop may run endlessly!                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|refresh until <place> is not visible on page                              |Refreshes current page until 'place' is not found somewhere on the page. Do not forget to set 'repeat at most times', or else the loop may run endlessly!                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|refresh until value of <place> is not <currentValue>                      |Refreshes current page until value of 'place' is no longer 'currentValue'. When 'place' cannot be found, or still has value 'currentValue' this method will return 'false'. Do not forget to set 'repeat at most times', or else the loop may run endlessly!                                                                                                                                                                                                                                                                                                                                           |
|refresh until value of <place> is <expectedValue>                         |Refreshes current page until value of 'place' is 'expectedValue'. When 'place' cannot be found, or does not have value 'expectedValue' this method will return 'false'. Do not forget to set 'repeat at most times', or else the loop may run endlessly!                                                                                                                                                                                                                                                                                                                                               |
|click <clickPlace> until value of <checkPlace> is not <currentValue>      |Clicks 'clickPlace' until value of 'checkPlace' is no longer 'currentValue'.  When 'checkPlace' cannot be found, or still has value 'currentValue' this method will return 'false'. (Test will be stopped if 'clickPlace' cannot be found.)                                                                                                                                                                                                                                                                                                                                                            |
|click <clickPlace> until value of <checkPlace> is <expectedValue>         |Clicks 'clickPlace' until value of 'checkPlace' is 'expectedValue'. When 'checkPlace' cannot be found, or does not have value 'expectedValue' this method will return 'false'. (Test will be stopped if 'clickPlace' cannot be found.)                                                                                                                                                                                                                                                                                                                                                                 |
|value of attribute <attribute> on <place>                                 |retrieves the value of the given attribute on the element identified by place                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|value of attribute <attribute> on <place> in <container>                  |retrieves the value of the given attribute on the element identified by place inside the given container                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|set search context to <container>                                         |Limits searches for 'places' by other keywords/commands to inside 'container' (i.e. the child-elements inside the container element), instead of the whole page. This is useful in case the same 'place' occurs multiple times on the same page, to ensure which one is found. All subsequent searches are limited to 'container' until either 'clear search context', 'open', 'back', 'forward', 'refresh' or one of the frame or tab manipulation commands is given. Many commands also offer an 'in <container>' version (e.g. 'click <place> in <container>') to limit searching only for that row.|
|clear search context                                                      |Removes any search limits previously set by 'set search context to <container>' (i.e. subesquent searches will search the entire page).                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|set implicit wait for angular to <true/false>                             |Controls whether !-BrowserTest-! should determine whether the site being tested uses !-AngularJs-! and if so, wait for Angular to finish rendering the page (default is 'false').                                                                                                                                                                                                                                                                                                                                                                                                                      |
|switch to frame <technical selector>                                      |Activates child frame of current (i)frame found using 'technical selector'.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |